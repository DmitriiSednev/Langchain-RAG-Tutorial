# RAG Tutorial с поддержкой различных форматов документов

Этот проект представляет собой систему RAG (Retrieval-Augmented Generation), которая позволяет задавать вопросы по содержимому различных документов (PDF, TXT, MD, DOCX и др.).

## Особенности

- Поддержка различных форматов документов (PDF, TXT, MD, DOCX и др.)
- Гибкая настройка эмбеддингов (OpenAI, Ollama, AWS Bedrock)
- Поддержка различных LLM (OpenAI GPT, Ollama)
- Интерактивный режим запросов
- Тесты для проверки функциональности
- Сравнение качества разных типов эмбеддингов

## Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/yourusername/rag-tutorial.git
cd rag-tutorial
```

2. Создайте виртуальное окружение и активируйте его:
```bash
python -m venv .venv
# Для Windows:
.venv\Scripts\activate
# Для Linux/Mac:
source .venv/bin/activate
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Создайте файл `.env` в корневой директории проекта и добавьте необходимые переменные окружения:
```env
OPENAI_API_KEY=your_api_key_here
EMBEDDING_TYPE=openai  # или ollama, или bedrock
LLM_TYPE=openai  # или ollama
```

## Использование

1. Поместите ваши документы в папку `data/`. Поддерживаются следующие форматы:
   - PDF файлы
   - Текстовые файлы (.txt)
   - Markdown файлы (.md)
   - Word документы (.docx)
   - и другие форматы, поддерживаемые LangChain

2. Создайте базу данных из ваших документов:
```bash
python create_database.py
```

3. Запустите интерактивный режим для запросов:
```bash
python query_database.py
```

4. Задавайте вопросы о содержимом документов. Например:
```
Ваш вопрос: сколько очков дается за самый длинный поезд в игре ticket_to_ride
```

## Сравнение эмбеддингов

Для сравнения качества и производительности разных типов эмбеддингов используйте:
```bash
python compare_embeddings.py
```

Этот скрипт:
- Тестирует разные типы эмбеддингов (OpenAI, Ollama) на одних и тех же вопросах
- Измеряет время ответа для каждого типа
- Сохраняет результаты в файл `embedding_comparison.json`

## Возможные проблемы и их решения

1. Ошибка с OpenAI API:
   - Проверьте, что у вас установлен правильный API ключ в файле `.env`
   - Убедитесь, что у вас есть доступ к API OpenAI

2. Ошибка с Chroma:
   - Убедитесь, что все зависимости установлены корректно
   - Попробуйте переустановить Chroma: `pip install --upgrade chromadb`

3. Ошибка с документами:
   - Проверьте, что документы находятся в папке `data/`
   - Убедитесь, что документы имеют поддерживаемый формат
   - Проверьте права доступа к файлам

## Тестирование

Для запуска тестов используйте:
```bash
pytest test_rag.py -v
```

## Структура проекта

- `create_database.py` - создание базы данных из документов
- `query_database.py` - интерактивный режим для запросов
- `get_embedding_function.py` - настройка функций эмбеддингов
- `compare_embeddings.py` - сравнение качества разных типов эмбеддингов
- `test_rag.py` - тесты системы
- `data/` - папка для документов
- `chroma/` - папка с базой данных (создается автоматически)

## Лицензия

MIT